<!doctype html>
<html lang="ja">
<head>
	<title>参加型プレゼンツール</title>
	<meta charset="utf-8">
	<script src="lib/jquery-1.11.1.min.js"></script>
	<script src="lib/jquery-ui.min.js"></script>
	<script src="js/slideChange.js"></script>
	<script src="js/slideFileSelect.js"></script>
	<script src="js/sort.js"></script>
	<script src="js/questionTool.js"></script>
	<link rel="stylesheet" type="text/css" href="css/slide.css">
	<link rel="stylesheet" type="text/css" href="lib/jquery-ui.min.css">
	<style>
	body{
		font: 62.5% "Trebuchet MS", sans-serif;
		margin: 50px;
	}
	#icons {
		margin: 0;
		padding: 0;
	}
	#icons li {
		margin: 2px;
		position: relative;
		padding: 4px 0;
		cursor: pointer;
		float: left;
		list-style: none;
	}
	#icons span.ui-icon {
		float: left;
		margin: 0 4px;
	}
	.fakewindowcontain .ui-widget-overlay {
		position: absolute;
	}
	select {
		width: 200px;
	}
	#toolmenu {
		width: 90px;
	}
	</style>
</head>
<body>
	<!-- メニュー -->
	<p>
		<input type="file" id="files" multiple> <input type="button" id="sort" value="スライドをソート">
	</p>
	<div id="toolmenu">
		<div>
			<button id="addTool">機能追加</button>
		</div>
		<ul>
			<li><a href="" id="questionTool">アンケート</a></li>
			<li><a href="" onclick="addComment(); return false;">感想</a></li>
		</ul>
	</div>
	<!-- アンケート機能追加時のダイアログ -->
	<div id="questionDialog" title="アンケート機能の追加">
		<input id="spinner">
		<p>選択肢の数を入力して下さい。</p>
	</div>

	<!-- スライド -->
	<figure id="slide"></figure>
	<div id="droparea"></div>

	<!-- アンケート -->
	<form style="margin-top: 1em;">
		<div id="question"></div>
	</form>
	<!-- スクリプト -->
	<script>
	$('input[type="button"]').button();
	$('input[type="file"]').button();
	//$('input.only').button();
	$( "#radioset" ).buttonset();

	$( "#spinner" ).spinner({
		max:10,
		min:1
	});
	//機能追加ボタンを押した時にメニューをプルダウンする関数
	$( function() {
		$( "#addTool" )
		.button( {
			text: true,
			icons: {
				primary: "ui-icon-triangle-1-s"
			}
		} )
		.click( function() {
			var menu = $( this ).parent().next().show().position( {
				my: "left top",
				at: "left bottom",
				of: this
			} );
			$( document ).one( "click", function() {
				menu.hide();
			} );
			return false;
		} )
		.parent()
		.buttonset()
		.next()
		.hide()
		.menu();
	} );

	var count=1;
	// ダイアログ
	$( "#questionDialog" ).dialog({
		autoOpen: false,
		width: 200,
		modal: true,
		buttons: [
		{
			text: "Ok",
			click: function() {
			// 追加したラジオボタンの固まりごとにドラッグ機能を付与
			var div = $('<div>').attr({id:"question-"+count}).draggable();
			$('#question').append(div);
			// 選択肢の数分だけボタンを作成
			for(var i = 0; i < $('#spinner').spinner("value"); i++){
				$('#question-'+count).append(jQuery("<input type='radio'/>").attr({
					id:"radio"+(i+1),
					name:"radio",
					value:i+1
				}).html("あ"));
			}
			count++;
			$( this ).dialog( "close" );
		}
	},
	{
		text: "Cancel",
		click: function() {
			$( this ).dialog( "close" );
		}
	}
	]
});

	// スライドのファイルを選択すると実行される
	// document.getElementById('files').addEventListener('change', slideFileSelect, false);と同様
	$('#files').on('change',slideFileSelect);
	$('#sort').click(sort);
	$('#questionTool').click(questionTool);

	</script>
</body>
</html>